{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "title": "VRT to Secure Code Warrior",
    "description": "Mapping from the Vulnerability Rating Taxonomy to Secure Code Warrior Trial module",
    "definitions": {
        "MappingMetadata": {
            "type": "object",
            "properties": {
                "default": {
                    "type": "null"
                }
            },
            "required": [
                "default"
            ]
        },
        "VRTid": {
            "type": "string",
            "pattern": "^[a-z_]*$"
        },
        "SCW": {
            "type": "string",
            "pattern": "^https:\\/\\/integration-api\\.securecodewarrior\\.com\\/api\\/v1\\/trial\\?id=bugcrowd&mappingList=vrt&mappingKey=[a-z_:]*$"
        },
        "Mapping": {
            "type": "object",
            "properties": {
                "id": {
                    "$ref": "#/definitions/VRTid"
                },
                "scw": {
                    "$ref": "#/definitions/SCW"
                }
            },
            "required": [
                "id",
                "scw"
            ],
            "additionalProperties": false
        },
        "MappingParent": {
            "type": "object",
            "properties": {
                "id": {
                    "$ref": "#/definitions/VRTid"
                },
                "children": {
                    "type": "array",
                    "items": {
                        "anyOf": [
                            {
                                "$ref": "#/definitions/MappingParent"
                            },
                            {
                                "$ref": "#/definitions/Mapping"
                            }
                        ]
                    }
                },
                "scw": {
                    "$ref": "#/definitions/SCW"
                }
            },
            "required": [
                "id",
                "children"
            ],
            "additionalProperties": false
        }
    },
    "type": "object",
    "required": [
        "metadata",
        "content"
    ],
    "properties": {
        "metadata": {
            "$ref": "#/definitions/MappingMetadata"
        },
        "content": {
            "type": "array",
            "items": {
                "anyOf": [
                    {
                        "$ref": "#/definitions/MappingParent"
                    },
                    {
                        "$ref": "#/definitions/Mapping"
                    }
                ]
            }
        }
    }
}