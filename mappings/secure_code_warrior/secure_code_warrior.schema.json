{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "title": "VRT to Secure Code Warrior",
    "description": "Mapping from the Vulnerability Rating Taxonomy to Secure Code Warrior Trial page",
    "definitions": {
        "MappingMetadata": {
            "type": "object",
            "properties": {
                "default": { "type": "null" }
            },
            "required": ["default"]
        },
        "VRTid": { "type": "string", "pattern": "^[a-z_]*$" },
        "SCW": {
            "type": ["string", "null"],
            "pattern": "^https:\\/\\/integration-api\\.securecodewarrior\\.com\\/api\\/v1\\/trial\\?id=bugcrowd&mappingList=vrt&mappingKey=[a-z_:]*&redirect=true$"
        },
        "Mapping": {
            "type": "object",
            "properties": {
                "id": { "$ref": "#/definitions/VRTid" },
                "secure_code_warrior" : { "$ref": "#/definitions/SCW" }
            },
            "required": ["id", "secure_code_warrior"],
            "additionalProperties": false
        },
        "MappingParent": {
            "type": "object",
            "properties": {
                "id": { "$ref": "#/definitions/VRTid" },
                "children": {
                    "type": "array",
                    "items" : {
                        "anyOf": [
                            { "$ref": "#/definitions/MappingParent" },
                            { "$ref": "#/definitions/Mapping" }
                        ]
                    }
                },
                "secure_code_warrior" : { "$ref": "#/definitions/SCW" }
            },
            "required": ["id", "children"],
            "additionalProperties": false
        }
    },
    "type": "object",
    "required": ["metadata", "content"],
    "properties": {
        "metadata": {
            "$ref": "#/definitions/MappingMetadata"
        },
        "content": {
            "type": "array",
            "items" : {
                "anyOf": [
                    { "$ref": "#/definitions/MappingParent" },
                    { "$ref": "#/definitions/Mapping" }
                ]
            }
        }
    }
}